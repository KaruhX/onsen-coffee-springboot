<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Gestión de Cafés - Onsen Coffee Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Rubik:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f6faf7',
                            100: '#e8f3eb',
                            200: '#d1e7d7',
                            300: '#a8d3b5',
                            400: '#76b88c',
                            500: '#4d9a6a',
                            600: '#3a7d54',
                            700: '#2f6445',
                            800: '#275038',
                            900: '#21422f',
                        }
                    },
                    fontFamily: {
                        sans: ['Rubik', 'system-ui', 'sans-serif'],
                        heading: ['Poppins', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Rubik', sans-serif;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50">

<!-- Navbar Admin -->
<div th:replace="fragments/admin-header.html :: header"></div>

<div class="max-w-7xl mx-auto px-4 py-8">
    <!-- Header -->
    <div class="mb-8">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 mb-1">Gestión de Cafés</h1>
                <p class="text-gray-600">Administra el catálogo de productos</p>
            </div>
            <a th:href="@{/admin/registerCoffee}"
               class="inline-flex items-center justify-center px-6 py-2.5 bg-primary-600 hover:bg-primary-700 text-white font-semibold rounded-lg shadow-sm hover:shadow-md transition-all">
                Agregar Nuevo Café
            </a>
        </div>
    </div>

    <!-- Tabla -->
    <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Imagen</th>
                        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Producto</th>
                        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Origen</th>
                        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Precio</th>
                        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Stock</th>
                        <th class="px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider">Acciones</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    <tr th:each="coffees : ${coffees}" class="hover:bg-gray-50 transition-colors">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <img th:src="@{/show-thumbnail(id=${coffees.id})}"
                                 onerror="this.src='https://images.unsplash.com/photo-1447933601403-0c6688de566e?w=80&h=80&fit=crop&q=80'"
                                 alt="Miniatura del café"
                                 class="w-16 h-16 rounded-lg object-cover border border-gray-200"/>
                        </td>
                        <td class="px-6 py-4">
                            <div class="flex flex-col">
                                <span class="text-sm font-semibold text-gray-900" th:text="${coffees.coffee_type}"></span>
                                <span class="text-xs text-gray-500" th:text="'ID: ' + ${coffees.id}"></span>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="text-sm text-gray-700" th:text="${coffees.origin}"></span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="text-sm font-semibold text-gray-900" th:text="'€' + ${coffees.price}"></span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span th:if="${coffees.stock > 10}" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800" th:text="${coffees.stock}"></span>
                            <span th:if="${coffees.stock > 0 and coffees.stock <= 10}" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800" th:text="${coffees.stock}"></span>
                            <span th:if="${coffees.stock == 0}" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Agotado</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <div class="flex items-center justify-end space-x-2">
                                <a th:href="@{/admin/editCoffee(id=${coffees.id})}"
                                   class="px-3 py-1.5 text-sm font-medium text-primary-700 bg-primary-50 rounded-lg hover:bg-primary-100 transition-colors">
                                    Editar
                                </a>
                                <form th:action="@{/admin/deleteCoffee}" method="post" class="inline-block"
                                      onsubmit="return confirm('¿Estás seguro de que deseas eliminar este café?');">
                                    <input type="hidden" name="id" th:value="${coffees.id}"/>
                                    <button type="submit"
                                            class="px-3 py-1.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 transition-colors">
                                        Eliminar
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(coffees)}" class="text-center py-12">
        <div class="inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-xl mb-4">
            <div class="w-8 h-8 bg-gray-300 rounded"></div>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">No hay cafés registrados</h3>
        <p class="text-gray-600 mb-4">Comienza agregando tu primer café al catálogo.</p>
        <a th:href="@{/admin/registerCoffee}"
           class="inline-flex items-center px-6 py-2.5 bg-primary-600 text-white font-semibold rounded-lg hover:bg-primary-700 transition-colors">
            Agregar Café
        </a>
    </div>
</div>

</body>
</html>

